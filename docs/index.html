<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Text Mining using 'dplyr', 'ggplot2', and Other Tidy Tools • tidytext</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">tidytext</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="/index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/tidytext.html">Get Started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/tf_idf.html">Term Frequency and Inverse Document Frequency (tf-idf) Using Tidy Data Principles</a>
    </li>
    <li>
      <a href="articles/tidying_casting.html">Converting to and from Document-Term Matrix and Corpus objects</a>
    </li>
    <li>
      <a href="articles/topic_modeling.html">Tidy Topic Modeling</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/juliasilge/tidytext">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="tidytext-text-mining-using-dplyr-ggplot2-and-other-tidy-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#tidytext-text-mining-using-dplyr-ggplot2-and-other-tidy-tools" class="anchor"></a>tidytext: Text mining using dplyr, ggplot2, and other tidy tools</h2>
<p><strong>Authors:</strong> <a href="http://juliasilge.com/">Julia Silge</a>, <a href="http://varianceexplained.org/">David Robinson</a><br><strong>License:</strong> <a href="https://opensource.org/licenses/MIT">MIT</a></p>
<p><a href="https://travis-ci.org/juliasilge/tidytext"><img src="https://travis-ci.org/juliasilge/tidytext.svg?branch=master" alt="Build Status"></a> <a href="https://ci.appveyor.com/project/juliasilge/tidytext"><img src="https://ci.appveyor.com/api/projects/status/github/juliasilge/tidytext?branch=master&amp;svg=true" alt="AppVeyor Build Status"></a> <a href="https://cran.r-project.org/package=tidytext"><img src="http://www.r-pkg.org/badges/version/tidytext" alt="CRAN_Status_Badge"></a> <a href="https://codecov.io/github/juliasilge/tidytext?branch=master"><img src="https://img.shields.io/codecov/c/github/juliasilge/tidytext/master.svg" alt="Coverage Status"></a> <a href="https://zenodo.org/badge/latestdoi/22224/juliasilge/tidytext"><img src="https://zenodo.org/badge/22224/juliasilge/tidytext.svg" alt="DOI"></a> <a href="http://joss.theoj.org/papers/89fd1099620268fe0342ffdcdf66776f"><img src="http://joss.theoj.org/papers/89fd1099620268fe0342ffdcdf66776f/status.svg" alt="status"></a> <a href="https://CRAN.R-project.org/package=tidytext"><img src="https://cranlogs.r-pkg.org/badges/tidytext" alt="Downloads"></a> <a href="https://CRAN.R-project.org/package=tidytext"><img src="https://cranlogs.r-pkg.org/badges/grand-total/tidytext?color=orange" alt="Total Downloads"></a></p>
<p>Using <a href="https://www.jstatsoft.org/article/view/v059i10">tidy data principles</a> can make many text mining tasks easier, more effective, and consistent with tools already in wide use. Much of the infrastructure needed for text mining with tidy data frames already exists in packages like <a href="https://cran.r-project.org/package=dplyr">dplyr</a>, <a href="https://cran.r-project.org/package=broom">broom</a>, <a href="https://cran.r-project.org/package=tidyr">tidyr</a> and <a href="https://cran.r-project.org/package=ggplot2">ggplot2</a>. In this package, we provide functions and supporting data sets to allow conversion of text to and from tidy formats, and to switch seamlessly between tidy tools and existing text mining packages. Check out <a href="https://www.tidytextmining.com/">our book</a> to learn more about text mining using tidy data principles.</p>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>You can install this package from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">"tidytext"</span>)</a></code></pre></div>
<p>Or you can install the development version from Github with <a href="https://github.com/hadley/devtools">devtools</a>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(devtools)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"juliasilge/tidytext"</span>)</a></code></pre></div>
</div>
<div id="tidy-text-mining-example-the-unnest_tokens-function" class="section level3">
<h3 class="hasAnchor">
<a href="#tidy-text-mining-example-the-unnest_tokens-function" class="anchor"></a>Tidy text mining example: the <code>unnest_tokens</code> function</h3>
<p>The novels of Jane Austen can be so tidy! Let’s use the text of Jane Austen’s 6 completed, published novels from the <a href="https://cran.r-project.org/package=janeaustenr">janeaustenr</a> package, and bring them into a tidy format. janeaustenr provides them as a one-row-per-line format:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(janeaustenr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">original_books &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/janeaustenr/topics/austen_books">austen_books</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(book) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">linenumber =</span> <span class="kw"><a href="http://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>()</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">original_books</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; # A tibble: 73,422 x 3</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt;    text                  book                linenumber</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt;    &lt;chr&gt;                 &lt;fct&gt;                    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt;  1 SENSE AND SENSIBILITY Sense &amp; Sensibility          1</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;  2 ""                    Sense &amp; Sensibility          2</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;  3 by Jane Austen        Sense &amp; Sensibility          3</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;  4 ""                    Sense &amp; Sensibility          4</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;  5 (1811)                Sense &amp; Sensibility          5</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;  6 ""                    Sense &amp; Sensibility          6</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;  7 ""                    Sense &amp; Sensibility          7</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;  8 ""                    Sense &amp; Sensibility          8</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;  9 ""                    Sense &amp; Sensibility          9</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; 10 CHAPTER 1             Sense &amp; Sensibility         10</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; # ... with 73,412 more rows</span></a></code></pre></div>
<p>To work with this as a tidy dataset, we need to restructure it as <strong>one-token-per-row</strong> format. The <code>unnest_tokens</code> function is a way to convert a dataframe with a text column to be one-token-per-row:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(tidytext)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">tidy_books &lt;-<span class="st"> </span>original_books <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="reference/unnest_tokens.html">unnest_tokens</a></span>(word, text)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">tidy_books</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; # A tibble: 725,055 x 3</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt;    book                linenumber word       </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt;    &lt;fct&gt;                    &lt;int&gt; &lt;chr&gt;      </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt;  1 Sense &amp; Sensibility          1 sense      </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt;  2 Sense &amp; Sensibility          1 and        </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt;  3 Sense &amp; Sensibility          1 sensibility</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;  4 Sense &amp; Sensibility          3 by         </span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;  5 Sense &amp; Sensibility          3 jane       </span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;  6 Sense &amp; Sensibility          3 austen     </span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;  7 Sense &amp; Sensibility          5 1811       </span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;  8 Sense &amp; Sensibility         10 chapter    </span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;  9 Sense &amp; Sensibility         10 1          </span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; 10 Sense &amp; Sensibility         13 the        </span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; # ... with 725,045 more rows</span></a></code></pre></div>
<p>This function uses the <a href="https://github.com/lmullen/tokenizers">tokenizers package</a> to separate each line into words. The default tokenizing is for words, but other options include characters, n-grams, sentences, lines, paragraphs, or separation around a regex pattern.</p>
<p>Now that the data is in one-word-per-row format, we can manipulate it with tidy tools like dplyr. We can remove stop words (kept in the tidytext dataset <code>stop_words</code>) with an <code>anti_join</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">data</span>(<span class="st">"stop_words"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">tidy_books &lt;-<span class="st"> </span>tidy_books <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">anti_join</a></span>(stop_words)</a></code></pre></div>
<p>We can also use <code>count</code> to find the most common words in all the books as a whole.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">tidy_books <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/tally.html">count</a></span>(word, <span class="dt">sort =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; # A tibble: 13,914 x 2</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt;    word       n</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt;  1 miss    1855</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;  2 time    1337</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;  3 fanny    862</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;  4 dear     822</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;  5 lady     817</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;  6 sir      806</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;  7 day      797</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt;  8 emma     787</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;  9 sister   727</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; 10 house    699</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; # ... with 13,904 more rows</span></a></code></pre></div>
<p>Sentiment analysis can be done as an inner join. Three sentiment lexicons are available via the <code><a href="reference/get_sentiments.html">get_sentiments()</a></code> function. Let’s examine how sentiment changes during each novel. Let’s find a sentiment score for each word using the Bing lexicon, then count the number of positive and negative words in defined sections of each novel.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="reference/get_sentiments.html">get_sentiments</a></span>(<span class="st">"bing"</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt; # A tibble: 6,788 x 2</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;    word        sentiment</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt;    &lt;chr&gt;       &lt;chr&gt;    </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt;  1 2-faced     negative </span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt;  2 2-faces     negative </span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;  3 a+          positive </span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt;  4 abnormal    negative </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;  5 abolish     negative </span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;  6 abominable  negative </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;  7 abominably  negative </span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt;  8 abominate   negative </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt;  9 abomination negative </span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">#&gt; 10 abort       negative </span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">#&gt; # ... with 6,778 more rows</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"></a>
<a class="sourceLine" id="cb7-18" data-line-number="18">janeaustensentiment &lt;-<span class="st"> </span>tidy_books <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">inner_join</a></span>(<span class="kw"><a href="reference/get_sentiments.html">get_sentiments</a></span>(<span class="st">"bing"</span>), <span class="dt">by =</span> <span class="st">"word"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/tally.html">count</a></span>(book, <span class="dt">index =</span> linenumber <span class="op">%/%</span><span class="st"> </span><span class="dv">80</span>, sentiment) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/spread">spread</a></span>(sentiment, n, <span class="dt">fill =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">sentiment =</span> positive <span class="op">-</span><span class="st"> </span>negative)</a>
<a class="sourceLine" id="cb7-23" data-line-number="23"></a>
<a class="sourceLine" id="cb7-24" data-line-number="24">janeaustensentiment</a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; # A tibble: 920 x 5</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt;    book                index negative positive sentiment</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt;    &lt;fct&gt;               &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt;  1 Sense &amp; Sensibility  0        16.0     26.0     10.0 </span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt;  2 Sense &amp; Sensibility  1.00     19.0     44.0     25.0 </span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt;  3 Sense &amp; Sensibility  2.00     12.0     23.0     11.0 </span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt;  4 Sense &amp; Sensibility  3.00     15.0     22.0      7.00</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt;  5 Sense &amp; Sensibility  4.00     16.0     29.0     13.0 </span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt;  6 Sense &amp; Sensibility  5.00     16.0     39.0     23.0 </span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt;  7 Sense &amp; Sensibility  6.00     24.0     37.0     13.0 </span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt;  8 Sense &amp; Sensibility  7.00     22.0     39.0     17.0 </span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt;  9 Sense &amp; Sensibility  8.00     30.0     35.0      5.00</span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt; 10 Sense &amp; Sensibility  9.00     14.0     18.0      4.00</span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt; # ... with 910 more rows</span></a></code></pre></div>
<p>Now we can plot these sentiment scores across the plot trajectory of each novel.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(janeaustensentiment, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(index, sentiment, <span class="dt">fill =</span> book)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_bar">geom_bar</a></span>(<span class="dt">stat =</span> <span class="st">"identity"</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>book, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">scales =</span> <span class="st">"free_x"</span>)</a></code></pre></div>
<p><img src="tools/README-unnamed-chunk-9-1.png" width="672"></p>
<p>For more examples of text mining using tidy data frames, see the tidytext vignette.</p>
</div>
<div id="tidying-document-term-matrices" class="section level3">
<h3 class="hasAnchor">
<a href="#tidying-document-term-matrices" class="anchor"></a>Tidying document term matrices</h3>
<p>Many existing text mining datasets are in the form of a DocumentTermMatrix class (from the tm package). For example, consider the corpus of 2246 Associated Press articles from the topicmodels dataset.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(tm)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">data</span>(<span class="st">"AssociatedPress"</span>, <span class="dt">package =</span> <span class="st">"topicmodels"</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">AssociatedPress</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt; &lt;&lt;DocumentTermMatrix (documents: 2246, terms: 10473)&gt;&gt;</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; Non-/sparse entries: 302031/23220327</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; Sparsity           : 99%</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; Maximal term length: 18</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; Weighting          : term frequency (tf)</span></a></code></pre></div>
<p>If we want to analyze this with tidy tools, we need to transform it into a one-row-per-term data frame first with a <code>tidy</code> function. (For more on the tidy verb, <a href="https://github.com/dgrtwo/broom">see the broom package</a>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a></span>(AssociatedPress)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; # A tibble: 302,031 x 3</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;    document term       count</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt;  1        1 adding      1.00</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;  2        1 adult       2.00</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt;  3        1 ago         1.00</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt;  4        1 alcohol     1.00</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;  5        1 allegedly   1.00</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;  6        1 allen       1.00</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;  7        1 apparently  2.00</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;  8        1 appeared    1.00</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;  9        1 arrested    1.00</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; 10        1 assault     1.00</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; # ... with 302,021 more rows</span></a></code></pre></div>
<p>We could find the most negative documents:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">ap_sentiments &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a></span>(AssociatedPress) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">inner_join</a></span>(<span class="kw"><a href="reference/get_sentiments.html">get_sentiments</a></span>(<span class="st">"bing"</span>), <span class="dt">by =</span> <span class="kw">c</span>(<span class="dt">term =</span> <span class="st">"word"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/tally.html">count</a></span>(document, sentiment, <span class="dt">wt =</span> count) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/spread">spread</a></span>(sentiment, n, <span class="dt">fill =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">sentiment =</span> positive <span class="op">-</span><span class="st"> </span>negative) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(sentiment)</a></code></pre></div>
<p>Or we can join the Austen and AP datasets and compare the frequencies of each word:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">comparison &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/broom/topics/tidy">tidy</a></span>(AssociatedPress) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/tally.html">count</a></span>(<span class="dt">word =</span> term) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">AP =</span> n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/join.html">inner_join</a></span>(<span class="kw"><a href="http://dplyr.tidyverse.org/reference/tally.html">count</a></span>(tidy_books, word)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">rename</a></span>(<span class="dt">Austen =</span> n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">AP =</span> AP <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(AP),</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">         <span class="dt">Austen =</span> Austen <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(Austen))</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9">comparison</a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; # A tibble: 4,437 x 3</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt;    word              AP     Austen</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt;    &lt;chr&gt;          &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt;  1 abandoned  0.000210  0.00000709</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt;  2 abide      0.0000360 0.0000284 </span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#&gt;  3 abilities  0.0000360 0.000206  </span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt;  4 ability    0.000294  0.0000213 </span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="co">#&gt;  5 abroad     0.000240  0.000255  </span></a>
<a class="sourceLine" id="cb12-18" data-line-number="18"><span class="co">#&gt;  6 abrupt     0.0000360 0.0000355 </span></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt;  7 absence    0.0000959 0.000787  </span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt;  8 absent     0.0000539 0.000355  </span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt;  9 absolute   0.0000659 0.000184  </span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt; 10 absolutely 0.000210  0.000674  </span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; # ... with 4,427 more rows</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="kw">library</span>(scales)</a>
<a class="sourceLine" id="cb12-26" data-line-number="26"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(comparison, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(AP, Austen)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-27" data-line-number="27"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-28" data-line-number="28"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_text">geom_text</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">label =</span> word), <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb12-29" data-line-number="29">            <span class="dt">vjust =</span> <span class="dv">1</span>, <span class="dt">hjust =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-30" data-line-number="30"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_x_log10</a></span>(<span class="dt">labels =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/scales/topics/percent_format">percent_format</a></span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-31" data-line-number="31"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_y_log10</a></span>(<span class="dt">labels =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/scales/topics/percent_format">percent_format</a></span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-32" data-line-number="32"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_abline">geom_abline</a></span>(<span class="dt">color =</span> <span class="st">"red"</span>)</a></code></pre></div>
<p><img src="tools/README-unnamed-chunk-13-1.png" width="768"></p>
<p>For more examples of working with objects from other text mining packages using tidy data principles, see the vignette on converting to and from document term matrices.</p>
</div>
<div id="community-guidelines" class="section level3">
<h3 class="hasAnchor">
<a href="#community-guidelines" class="anchor"></a>Community Guidelines</h3>
<p>This project is released with a <a href="CONDUCT.md">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms. Feedback, bug reports (and fixes!), and feature requests are welcome; file issues or seek support <a href="http://github.com/juliasilge/tidytext/issues">here</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=tidytext">https://​cran.r-project.org/​package=tidytext</a>
</li>
<li>Browse source code at <br><a href="http://github.com/juliasilge/tidytext">http://​github.com/​juliasilge/​tidytext</a>
</li>
<li>Report a bug at <br><a href="http://github.com/juliasilge/tidytext/issues">http://​github.com/​juliasilge/​tidytext/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE.html">LICENSE</a></p>
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing tidytext</a></li>
</ul>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>David Robinson <br><small class="roles"> Author </small> </li>
<li>Julia Silge <br><small class="roles"> Author, maintainer </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by David Robinson, Julia Silge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
